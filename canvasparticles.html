<!DOCTYPE html>
<html>
<head>
	<title>Animated backgrounds</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://fonts.googleapis.com/css?family=Gugi" rel="stylesheet">

<style>
body {
	margin: 0; 
	padding: 0;
	font-family: 'Gugi', cursive;
}
h1 {
	position: absolute;
	bottom: -65px; left: -105px;
	width: 200%;
	transform: rotate(10deg);
	z-index: -10;
}
#canvas1 {
	position: absolute;
	width: 100%;
	height: 100%;
	z-index: -1000;
	//display: none;
}
#controlsWrapper {
	position: absolute;
	width: auto;
	min-width: 260px;
	height: 202px;
	top: 20%;
	left: 50%;
	transform: translate(-50%, 0);
}
#controls {
	position: absolute;
	width: 260px;
	height: 202px;
	//background: rgba(255,255,255,.1);
	top: 5%;
	left: 50%;
	transform: translate(-50%, 0);
	z-index: 100;
	border-radius: 5px;
	overflow: hidden;
}

#controls:before {
	content: 'Particle behaviours';
	position: absolute;
	bottom: -12px; left: -103px;
	width: 150%;
	height: 30px;
	color: rgba(255,255,255,0.8);
	font-size: 32px;
	z-index: 10;
	transform: rotate(10deg);
	overflow: hidden;
	
}
.button {
	position: relative;
	top:0; left: 0;
	float: left;
	width: 50px; height: 50px;
	background: rgba(0,0,0,.5);
	margin-right: 2px;
	border-radius: 5px;
	text-align: center;
	line-height: 50px;
	font-size: 30px;
	color: #000;
	transition: .5s;
}

.button:hover, .button.active {
	background: rgba(0,0,0,.9);
	color: #fff;
}
.infoBoard {
	position: relative;
	width: 242px;
	margin-top: 2px;
	height: 150px;
	top:0; left:0;
	float: left;
	background: rgba(0,0,0,.8);
	border-radius: 5px;
	padding: 8px;
	text-align: justify;
	font-size: 15px;
	line-height: 16px;
	color: #fff;
	
}
</style>
<body>
<canvas id='canvas1'></canvas>	

<div id='controlsWrapper'>
	<h1>Particle behaviours</h1>
	<div id='controls'>
		<div class='button button1 active'>1</div>
		<div class='button button2'>2</div>
		<div class='button button3'>3</div>
		<div class='button button4'>4</div>
		<div class='button button5'>5</div>
		<div class='infoBoard'>
		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
		</div>
	</div>
</div>
<script>
let activeEffect = 1;
// CANVAS ///////////////////////////////////
const canvas = document.getElementById("canvas1");
const ctx = canvas.getContext("2d");
ctx.canvas.width  = window.innerWidth;
ctx.canvas.height = window.innerHeight;
let particleArray = [];
let angle = 0;

// MOUSE POSITION ///////////////////////////
let mouse = {
	x: undefined,
	y: undefined
}
window.addEventListener('mousemove', 
	function(event){
		mouse.x = event.x;
		mouse.y = event.y;
		//console.log(mouse);
});

// RANGE OF SIZES FOR PARTICLES (on mouse hover)
const maxSize = 25;
const minSize = 3;

// SOME RANDOM COLOURS https://color.adobe.com/create/color-wheel/
const colorArray = [
	'#2FC1E4',
	'#21A4D3',
	'#048CAC',
	'#145674',
	'#023855'
];



// CREATE PARTICLE OBJECT ///////////////////
function Particle(x, y, dx, dy, size, color, density){
	this.x = x;
	this.y = y;
	this.dx = dx;
	this.dy = dy;
	this.size = size;
	this.minSize = size;
	this.color = colorArray[Math.floor(Math.random()*colorArray.length)];
	this.density =  Math.random() * 2;
	
	this.draw = function(){
		//ctx.clearRect(0,0,innerWidth,innerHeight);
		ctx.beginPath();
		ctx.arc(this.x,this.y,this.size,0,Math.PI * 2, false);
		//ctx.strokeStyle = 'blue';
		//ctx.stroke();
		ctx.fillStyle = this.color;
		ctx.fill();
	}
	this.update = function(){
		
		//////////////////////////////// EFFECT 1 ////////////////////////////
		if (activeEffect == 1){
			if (this.x + this.size > canvas.width || this.x - this.size < 0){
				this.dx = -this.dx;
			}
			if (this.y + this.size > canvas.height || this.y - this.size < 0){
				this.dy = -this.dy;
			}
			this.x += this.dx; 
			this.y += this.dy;
			
			//interactivity
			if (mouse.x - this.x < 50 && mouse.x - this.x >-50 &&
				mouse.y - this.y < 50 && mouse.y - this.y >-50){
				if (this.size < maxSize){
				this.size += 1;
				}
			} else if (this.size > this.minSize){
				this.size -= 1;
			}
		}
		//////////////////////////////// EFFECT 2 ////////////////////////////
		if (activeEffect == 2){
			//console.log(particleArray.length);
			angle += 0.00001;
				//let part = particleArray[i];
				this.y += Math.pow(this.density, 1.1) + 1.5;
				this.x += Math.sin(angle) * .3;
			
				// if it reaches bottom add new one to the top
				if (this.y > canvas.height + 10){
						this.x = Math.random() * (innerWidth - size * 2) + size;
						this.y = -10;
				};
				/// bouncing from mouse
				if (mouse.x - this.x < 20 && mouse.y - this.y > 1 && mouse.y - this.y > -1  ){
					this.x+= 0.5;
				} 
				if (mouse.x - this.x >-20 && mouse.y - this.y > 10 && mouse.y - this.y > -10  ){
					this.x-= 0.5;
				} 
				//mouse.y - this.y < 1 && mouse.y - this.y >-100){
				
		}
				
			

		
	this.draw();
	}
}


// RESIZE SETTING - empty and refill particle array every time window changes size + change canvas size
window.addEventListener('resize',
	function(){
		canvas.width = innerWidth;
		canvas.height = innerHeight;
		init();
	}
)

function init() {
	particleArray = [];
	for (let i = 0; i < 500; i++){
		let size = Math.random() * innerHeight/80 + innerHeight/350; //PARTICLE SIZE DEPENDING ON WINDOW HEIGHT
		let x = Math.random() * (innerWidth - size * 2) + size;
		let y = Math.random() * (innerHeight - size * 2) + size;
		let dx = (Math.random() - 0.5) * .5;
		let dy = (Math.random() - 0.5) * .5;
		let density = Math.random() + 1 //determines how fast it falls;
		particleArray.push(new Particle(x, y, dx, dy, size));
	}
}

// ANIMATION LOOP ///////////////////////////////////////
function animate(){
	requestAnimationFrame(animate);
	ctx.clearRect(0,0,innerWidth,innerHeight);
	
	for (let i = 0; i < particleArray.length; i++){
		particleArray[i].update();
	}
}
init();
animate();

//CONTROLS, BUTTONS 1 - 5 ////////////////////////////
const buttons = document.querySelectorAll('.button');
buttons.forEach(button => button.addEventListener('click', function(){
	//console.log(this.classList);
	for (let i = 0; i < buttons.length; i++){
		buttons[i].classList.remove('active');
	}
	this.classList.add('active');
	activeEffect = this.textContent;
	console.log(activeEffect);
	init();
	/*for (let i = 0; i < buttons.length; i++){
		console.log(this.classList);
		button[i].classList.remove('active');
	}*/
}))

</script>

</body>
</html>

