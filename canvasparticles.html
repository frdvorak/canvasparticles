<!DOCTYPE html>
<html>
<head>
	<title>Animated backgrounds</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://fonts.googleapis.com/css?family=Gugi" rel="stylesheet">

<style>
body {
	margin: 0; 
	padding: 0;
	font-family: 'Gugi', cursive;
}
h1 {
	position: absolute;
	bottom: -65px; left: -105px;
	width: 200%;
	transform: rotate(10deg);
	z-index: -10;
}
#canvas1 {
	position: absolute;
	width: 100%;
	height: 100%;
	z-index: -1000;
	//display: none;
}
#controlsWrapper {
	position: absolute;
	width: auto;
	min-width: 260px;
	height: 202px;
	top: 20%;
	left: 50%;
	transform: translate(-50%, 0);
}
#controls {
	position: absolute;
	width: 260px;
	height: 202px;
	//background: rgba(255,255,255,.1);
	top: 5%;
	left: 50%;
	transform: translate(-50%, 0);
	z-index: 100;
	border-radius: 5px;
	overflow: hidden;
}

#controls:before {
	content: 'Particle behaviours';
	position: absolute;
	bottom: -12px; left: -103px;
	width: 150%;
	height: 30px;
	color: rgba(255,255,255,0.8);
	font-size: 32px;
	z-index: 10;
	transform: rotate(10deg);
	overflow: hidden;
	
}
.button {
	position: relative;
	top:0; left: 0;
	float: left;
	width: 50px; height: 50px;
	background: rgba(0,0,0,.5);
	margin-right: 2px;
	border-radius: 5px;
	text-align: center;
	line-height: 50px;
	font-size: 30px;
	color: #000;
	transition: .5s;
}

.button:hover, .button.active {
	background: rgba(0,0,0,.9);
	color: #fff;
}
.infoBoard {
	position: relative;
	width: 242px;
	margin-top: 2px;
	height: 150px;
	top:0; left:0;
	float: left;
	background: rgba(0,0,0,.8);
	border-radius: 5px;
	padding: 8px;
	text-align: justify;
	font-size: 15px;
	line-height: 16px;
	color: #fff;
	
}
#slider {
	width: 235px;
}
</style>
<body>
<canvas id='canvas1'></canvas>	

<div id='controlsWrapper'>
	<h1>Particle behaviours</h1>
	<div id='controls'>
		<div class='button button1 active'>1</div>
		<div class='button button2'>2</div>
		<div class='button button3'>3</div>
		<div class='button button4'>4</div>
		<div class='button button5'>5</div>
		<div class='infoBoard'>
		<p>
		1 - floating
		2 - snow
		3 - cross streams
		4 - bouncing
		5 - bubbles 
		Can be used as an interactive background for a website
		</p>
		<input type='range' id='slider' name='slider' min='1' max='2' value='2'>
		</div>
	</div>
</div>
<script>
let activeEffect = 1;
// CANVAS ///////////////////////////////////
const canvas = document.getElementById("canvas1");
const ctx = canvas.getContext("2d");
ctx.canvas.width  = window.innerWidth;
ctx.canvas.height = window.innerHeight;
const slider = document.querySelector('#slider');
let particleArray = [];
let angle = 0;
let sliderValue = 1;




// MOUSE POSITION ///////////////////////////
let mouse = {
	x: undefined,
	y: undefined
}

setInterval(function(){
	mouse.x = undefined;
	mouse.y = undefined;
}, 5000);

window.addEventListener('mousemove', 
	function(event){
		mouse.x = event.x;
		mouse.y = event.y;
		//console.log(mouse);
});

// RANGE OF SIZES FOR PARTICLES (on mouse hover)
let maxSize = innerWidth/17;
let minSize = 3;

// SOME RANDOM COLOURS https://color.adobe.com/create/color-wheel/
const colorArray1 = [
	'#2FC1E4',
	'#21A4D3',
	'#048CAC',
	'#145674',
	'#023855'
];
const colorArray2 = [
	'#fff',
	'#000',
	'blue',
	'green',
	'red'
];

// SLIDER INPUT /////////////////////////////

slider.addEventListener('change', function(){
	sliderValue = slider.value;
	console.log(sliderValue);
	init();

})

// CREATE PARTICLE OBJECT ///////////////////
function Particle(x, y, dx, dy, size, color, density, bounceFactor, vy, randomize){
	this.x = x;
	this.y = y;
	this.dx = dx;
	this.dy = dy;
	this.size = size;
	this.minSize = size;
	this.color = colorArray1[Math.floor(Math.random()*colorArray1.length)];
	this.density = 0.3 + (Math.random() * 0.2)+0.1;
	this.bounceFactor = 0.7;
	this.vy = 1;
	this.randomize = (Math.random() * 1)+15;
	
									if (sliderValue == 1){
							this.color = colorArray1[Math.floor(Math.random()*colorArray1.length)];
						} else if (sliderValue == 2){
							this.color = colorArray2[Math.floor(Math.random()*colorArray2.length)];
						}
	
	this.draw = function(){
		//ctx.clearRect(0,0,innerWidth,innerHeight);
		ctx.beginPath();
		ctx.arc(this.x,this.y,this.size,0,Math.PI * 2, false);
		ctx.strokeStyle = 'black';
		ctx.stroke();
		ctx.fillStyle = this.color;
		ctx.fill();
	}
	
	this.update = function(){

		//////////////////////////////// EFFECT 1 ////////////////////////////
		if (activeEffect == 1){
			if (this.x + this.size > canvas.width || this.x - this.size < 0){
				this.dx = -this.dx;
			}
			if (this.y + this.size > canvas.height || this.y - this.size < 0){
				this.dy = -this.dy;
			}
			this.x += this.dx; 
			this.y += this.dy;

			//interactivity
			if (mouse.x - this.x < 50 && mouse.x - this.x >-50 &&
				mouse.y - this.y < 50 && mouse.y - this.y >-50){
				if (this.size < maxSize){
				this.size += 1;
				}
			} else if (this.size > this.minSize){
				this.size -= 0.1;
			}
		}
		//////////////////////////////// EFFECT 2 ////////////////////////////
		if (activeEffect == 2){
			angle += 0.00001;
				this.y += this.density*5;
				this.x += Math.sin(angle) * .3;
			
				// if it reaches bottom add new one to the top
				if (this.y > canvas.height + 10){
						this.x = Math.random() * (innerWidth - size * 2) + size;
						this.y = -10;
				};
				/// bouncing from mouse
				if (mouse.x - this.x < this.density*100 && mouse.x - this.x >0 &&
				mouse.y - this.y < this.density*40 && mouse.y - this.y >-this.density*40){
				this.x-=2;
				this.y-=2;
				}
				if (mouse.x - this.x < 0 && mouse.x - this.x >-this.density*100 &&
				mouse.y - this.y < this.density*40 && mouse.y - this.y >-this.density*40){
				this.x+=3;
				this.y-=2;
				}		
		} 
		//////////////////////////////// EFFECT 3 ////////////////////////////
		if (activeEffect == 3){
				this.size+=0.15;
				if (this.x < innerWidth/2 && this.y < innerHeight/2){
					this.x-=2;
					this.y-=0.9 ;
				}
				if (this.x < innerWidth/2 && this.y > innerHeight/2){
					this.x-=2;
					this.y+=0.9;
				}
				if (this.x > innerWidth/2 && this.y > innerHeight/2){
					this.x+=2;
					this.y+=0.9;
				}
				if (this.x > innerWidth/2 && this.y < innerHeight/2){
					this.x+=2;
					this.y-=0.9;
				}
				if (this.x < 0-this.size || this.x > innerWidth+this.size){
					this.x =  innerWidth/2 + (Math.random() * innerWidth/2)-innerWidth/4;
					this.y =  innerHeight/2 + (Math.random() * innerHeight/2)-innerHeight/4;
					this.size = 1;
				}
				if (this.y < 0-this.size || this.y > innerHeight+this.size){
					this.x =  Math.random() * innerWidth;
					this.y =  Math.random() * innerHeight;
					this.size = 1;
				}
				//interactivity
				if (mouse.x - this.x < 50 && mouse.x - this.x > -50 &&
				mouse.y - this.y < 50 && mouse.y - this.y >0){
					this.y-=4;
					//this.x+=(Math.random() * 1)-0.5;
				}
				if (mouse.x - this.x < 50 && mouse.x - this.x > -50 &&
				mouse.y - this.y < 0 && mouse.y - this.y >-50){
					this.y+=4;
					//this.x+=(Math.random() * 1)-0.5;
				}
				/*
				if (mouse.x - this.x < 0 && mouse.x - this.x >-50 &&
				mouse.y - this.y < 50 && mouse.y - this.y >-50){
				//this.x+=1;
				this.y+=1;
				}*/
		}
		//////////////////////////////// EFFECT 4 ////////////////////////////
		if (activeEffect == 4){
				//this.density = (Math.random() * 1)-0.5;
				this.y += this.vy;
				this.vy += this.density;
									
				// if it reaches bottom add new one to the top
				if (this.y > canvas.height-this.size){
						this.vy *= -this.bounceFactor;
				};
				
				if ((this.y > innerHeight - innerHeight/5) &&(mouse.x - this.x < 20 && mouse.x - this.x >-20 &&
				mouse.y - this.y < 1250 && mouse.y - this.y >-1250)){
				//this.x+=1;
				this.vy-=2.7;
				}
		}
		//////////////////////////////// EFFECT 5 ////////////////////////////
		if (activeEffect == 5){
				angle += this.density/71;
				//this.vy += this.density;
				this.y -= this.density+this.randomize/30;
				this.x = this.x + Math.sin(angle) * 0.8;
				this.size += this.density/2;

				// if it reaches 'maxSize-6' make it transparent
				if (this.size > maxSize){
						this.color = "rgba(255, 255, 255, 0.6)";
				};
				
				// if it reaches 'maxSize' pop and add one to the bottom of screen
				if (this.size > maxSize+this.randomize){
						this.y = innerHeight/2 + (Math.random()*innerHeight/4)+innerHeight/4;
						this.x = (Math.random()*innerWidth*2)-innerWidth;
						this.size = (Math.random() * 0.1)+0.1;
						this.vy = 0.01;
						if (sliderValue == 1){
							this.color = colorArray1[Math.floor(Math.random()*colorArray1.length)];
						} else if (sliderValue == 2){
							this.color = colorArray2[Math.floor(Math.random()*colorArray2.length)];
						}
				};
				
				//interactivity
				if (mouse.x - this.x < 50 && mouse.x - this.x > -50 &&
				mouse.y - this.y < 50 && mouse.y - this.y >-50){
					this.size+=2;
				}
				
		}
	this.draw();
	}
}

// RESIZE SETTING - empty and refill particle array every time window changes size + change canvas size
window.addEventListener('resize',
	function(){
		canvas.width = innerWidth;
		canvas.height = innerHeight;
		maxSize = innerWidth/17;
		init();
	}
)

function init() {
	particleArray = [];
	for (let i = 0; i < 900; i++){
		let size = Math.random() * innerHeight/80 + innerHeight/350; //PARTICLE SIZE DEPENDING ON WINDOW HEIGHT
		let x = Math.random() * (innerWidth - size * 2) + size;
		let y = Math.random() * (innerHeight - size * 2) + size;
		let dx = (Math.random() - 0.5) * .5;
		let dy = (Math.random() - 0.5) * .5;
		let density = Math.random() + 1 //determines how fast it falls;
		particleArray.push(new Particle(x, y, dx, dy, size));
	}
}

// ANIMATION LOOP ///////////////////////////////////////
function animate(){
	requestAnimationFrame(animate);
	ctx.clearRect(0,0,innerWidth,innerHeight);
	
	for (let i = 0; i < particleArray.length; i++){
		particleArray[i].update();
	}
}
init();
animate();

//CONTROLS, BUTTONS 1 - 5 ////////////////////////////
const buttons = document.querySelectorAll('.button');
buttons.forEach(button => button.addEventListener('click', function(){
	//console.log(this.classList);
	for (let i = 0; i < buttons.length; i++){
		buttons[i].classList.remove('active');
	}
	this.classList.add('active');
	activeEffect = this.textContent;
	console.log(activeEffect);
	init();
	/*for (let i = 0; i < buttons.length; i++){
		console.log(this.classList);
		button[i].classList.remove('active');
	}*/
}))

</script>

</body>
</html>

